(()=>{const d=document,w=window,reduce=w.matchMedia('(prefers-reduced-motion: reduce)').matches;d.body.classList.remove('no-js');const navBtn=d.querySelector('.nav-toggle'),nav=d.querySelector('.site-nav');if(navBtn&&nav){const closeNav=()=>{nav.classList.remove('open');navBtn.setAttribute('aria-expanded','false')};navBtn.addEventListener('click',()=>{const open=nav.classList.toggle('open');navBtn.setAttribute('aria-expanded',String(open))});nav.querySelectorAll('a').forEach(a=>a.addEventListener('click',closeNav));d.addEventListener('click',e=>{if(nav.classList.contains('open')&&!nav.contains(e.target)&&!navBtn.contains(e.target))closeNav()});d.addEventListener('keydown',e=>{if(e.key==='Escape')closeNav()})}if(!reduce&&'IntersectionObserver'in w){const io=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.classList.add('in');io.unobserve(entry.target)}})},{threshold:.14});d.querySelectorAll('.reveal').forEach(el=>io.observe(el))}else d.querySelectorAll('.reveal').forEach(el=>el.classList.add('in'));const initHeroVideo=()=>{const section=d.querySelector('.hero-video-section'),pin=d.querySelector('.hero-pin'),video=d.querySelector('.hero-video');if(!section||!pin||!video||reduce)return;const gsap=w.gsap,ScrollTrigger=w.ScrollTrigger;if(!gsap||!ScrollTrigger)return;gsap.registerPlugin(ScrollTrigger);video.pause();video.currentTime=0;const setup=()=>{if(!Number.isFinite(video.duration)||video.duration<=0)return;const endValue=Math.max(1800,Math.round(video.duration*520));gsap.to(video,{currentTime:video.duration,ease:'none',scrollTrigger:{trigger:section,start:'top top',end:`+=${endValue}`,scrub:.45,pin:pin,invalidateOnRefresh:true,anticipatePin:1}})};if(video.readyState>=1)setup();else video.addEventListener('loadedmetadata',setup,{once:true})};const initReviewsSlider=()=>{const root=d.querySelector('.reviews-swiper');if(!root)return;const wrap=root.querySelector('.swiper-wrapper');const Swiper=w.Swiper;if(!wrap||!Swiper)return;let slides=[...wrap.children];if(!slides.length)return;for(let i=slides.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[slides[i],slides[j]]=[slides[j],slides[i]]}const target=Math.min(9,Math.max(6,slides.length));const original=[...slides];let idx=0;while(slides.length<target){slides.push(original[idx%original.length].cloneNode(true));idx++}slides=slides.slice(0,target);wrap.innerHTML='';slides.forEach(s=>{const rating=Math.random()<.45?'4.5/5':'5.0/5';const stars=s.querySelector('[data-stars]');const text=s.querySelector('[data-rating-text]');if(stars)stars.textContent=rating==='4.5/5'?'★★★★☆':'★★★★★';if(text)text.textContent=rating;wrap.appendChild(s)});new Swiper('.reviews-swiper',{loop:true,speed:900,spaceBetween:16,slidesPerView:1,autoplay:{delay:2400,disableOnInteraction:false,pauseOnMouseEnter:true},pagination:{el:'.swiper-pagination',clickable:true},breakpoints:{768:{slidesPerView:2},1100:{slidesPerView:3}}})};w.addEventListener('load',()=>{initHeroVideo();initReviewsSlider()})})();