(()=>{const d=document,w=window,reduce=w.matchMedia('(prefers-reduced-motion: reduce)').matches;const isLowMemory=()=>((typeof navigator.deviceMemory==='number'&&navigator.deviceMemory<=2)||(navigator.connection&&navigator.connection.saveData===true));d.body.classList.remove('no-js');const navBtn=d.querySelector('.nav-toggle'),nav=d.querySelector('.site-nav');if(navBtn&&nav){const closeNav=()=>{nav.classList.remove('open');navBtn.setAttribute('aria-expanded','false')};navBtn.addEventListener('click',()=>{const open=nav.classList.toggle('open');navBtn.setAttribute('aria-expanded',String(open))});nav.querySelectorAll('a').forEach(a=>a.addEventListener('click',closeNav));d.addEventListener('click',e=>{if(nav.classList.contains('open')&&!nav.contains(e.target)&&!navBtn.contains(e.target))closeNav()});d.addEventListener('keydown',e=>{if(e.key==='Escape')closeNav()})}if(!reduce&&'IntersectionObserver'in w){const io=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.classList.add('in');io.unobserve(entry.target)}})},{threshold:.14});d.querySelectorAll('.reveal').forEach(el=>io.observe(el))}else d.querySelectorAll('.reveal').forEach(el=>el.classList.add('in'));const initScrollSmoother=()=>{const gsap=w.gsap,ScrollTrigger=w.ScrollTrigger,ScrollSmoother=w.ScrollSmoother,wrapper=d.getElementById('smooth-wrapper'),content=d.getElementById('smooth-content');if(reduce||isLowMemory()||!gsap||!ScrollTrigger||!ScrollSmoother||!wrapper||!content)return null;gsap.registerPlugin(ScrollTrigger,ScrollSmoother);if(ScrollSmoother.get())return ScrollSmoother.get();return ScrollSmoother.create({wrapper:'#smooth-wrapper',content:'#smooth-content',smooth:1.05,smoothTouch:0,normalizeScroll:true,effects:false,ignoreMobileResize:true})};const initHeroVideo=()=>{const section=d.querySelector('.hero-video-section'),pin=d.querySelector('.hero-pin'),video=d.querySelector('.hero-video');if(!section||!pin||!video)return;if(reduce||isLowMemory()){section.classList.add('reduced-motion');video.pause();return}const gsap=w.gsap,ScrollTrigger=w.ScrollTrigger;if(!gsap||!ScrollTrigger)return;gsap.registerPlugin(ScrollTrigger);const mobileMq=w.matchMedia('(max-width: 767px)');const desktopSrc=video.dataset.desktopSrc||'',mobileSrc=video.dataset.mobileSrc||desktopSrc;const sourceEl=video.querySelector('source');let activeSource='',duration=0,heroTrigger=null,booted=false;const clamp=(v,min,max)=>Math.min(max,Math.max(min,v));let scrubToTime=null;const kill=()=>{if(heroTrigger){heroTrigger.kill();heroTrigger=null}};const start=()=>{if(booted)return;duration=video.duration||0;if(!duration)return;booted=true;video.pause();video.currentTime=0;scrubToTime=gsap.quickTo(video,'currentTime',{duration:.2,ease:'none'});kill();heroTrigger=ScrollTrigger.create({id:'heroVideoPin',trigger:section,start:'top top',end:()=>`+=${Math.round(w.innerHeight*3.2)}`,pin:pin,pinSpacing:true,scrub:1.2,anticipatePin:1,invalidateOnRefresh:true,onUpdate:self=>{const nextTime=clamp(self.progress*duration,0,Math.max(duration-.016,0));if(scrubToTime)scrubToTime(nextTime);else video.currentTime=nextTime}});ScrollTrigger.refresh()};const watchReady=()=>{if(video.readyState>=1){start();return}video.addEventListener('loadedmetadata',start,{once:true});video.addEventListener('loadeddata',start,{once:true})};const applySource=()=>{const nextSource=mobileMq.matches?mobileSrc:desktopSrc;if(!nextSource||nextSource===activeSource)return;activeSource=nextSource;booted=false;kill();if(sourceEl){sourceEl.setAttribute('src',nextSource)}else{video.setAttribute('src',nextSource)}video.load();watchReady()};applySource();const refresh=()=>{if(heroTrigger)ScrollTrigger.refresh();if(w.ScrollSmoother&&w.ScrollSmoother.get())w.ScrollSmoother.get().refresh()};if(typeof mobileMq.addEventListener==='function'){mobileMq.addEventListener('change',applySource)}else if(typeof mobileMq.addListener==='function'){mobileMq.addListener(applySource)}w.addEventListener('resize',refresh,{passive:true});w.addEventListener('orientationchange',refresh,{passive:true});w.addEventListener('load',refresh,{once:true});d.addEventListener('visibilitychange',()=>{if(!d.hidden)refresh()})};const initReviewsSlider=()=>{const root=d.querySelector('.reviews-swiper'),Swiper=w.Swiper;if(!root||!Swiper)return;const wrap=root.querySelector('.swiper-wrapper');if(!wrap)return;let slides=[...wrap.children];if(!slides.length)return;for(let i=slides.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[slides[i],slides[j]]=[slides[j],slides[i]]}const target=Math.min(9,Math.max(6,slides.length));const base=[...slides];let idx=0;while(slides.length<target){slides.push(base[idx%base.length].cloneNode(true));idx++}slides=slides.slice(0,target);wrap.innerHTML='';slides.forEach(s=>{const rating=Math.random()<.45?'4.5/5':'5.0/5';const stars=s.querySelector('[data-stars]');const txt=s.querySelector('[data-rating-text]');if(stars)stars.textContent=rating==='4.5/5'?'★★★★☆':'★★★★★';if(txt)txt.textContent=rating;wrap.appendChild(s)});new Swiper('.reviews-swiper',{loop:true,speed:900,spaceBetween:16,slidesPerView:1,autoplay:{delay:2600,disableOnInteraction:false,pauseOnMouseEnter:true},pagination:{el:'.swiper-pagination',clickable:true},breakpoints:{768:{slidesPerView:2},1100:{slidesPerView:3}}})};w.addEventListener('load',()=>{initScrollSmoother();initHeroVideo();initReviewsSlider()})})();